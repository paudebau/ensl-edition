% -*- mode: latex, coding: iso-safe-unix -*-
% Time-stamp: <2017-04-07 06:38:53 (paudebau)>

\def\filename{pnp.tutorials.sty}
\def\fileversion{1.0}
\def\filedate{2017/01/06}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{\@currname}[\filedate\space v\fileversion\space pnp stuff introduced in tutorials]

% TeXmacs

\newcommand{\nequiv}{\not\equiv}
\newcommand{\mrel}[1]{\mathrel{#1}}
\newcommand{\marked}[1]{{\color{red} #1}}

% \begin{mdframed}[hidealllines=true,backgroundcolor=blue!20]

% misc.

\newcommand{\idgen}[1]{\ensuremath{\langle{#1}\rangle}}
\newcommand{\bnf}{\mathrel{::=}}

% Inferences

\newcommand{\Rule}[2]{\displaystyle\frac{#1}{#2}}
\newcommand{\rRule}[3]{\displaystyle\frac{#2}{#3}\ (\ensuremath{#1})}
\newcommand{\lRule}[3]{(\ensuremath{#1})\ \displaystyle\frac{#2}{#3}}

% cat. syntaxiques

\newcommand{\keyw}[1]{\text{\sffamily{\bfseries{#1}}}}
\newcommand{\mathkeyw}[1]{\ensuremath{\boldsymbol{#1}}}
\newcommand{\valuew}[1]{\text{{\color{blue} #1}}}
\newcommand{\typew}[1]{\text{\sffamily{\bfseries{#1}}}}

\makeatletter
\DeclareDocumentCommand \newconstant { s o m } {
  \message{keyword K#3 = <#1,#2> ^^J}
  \expandafter\newcommand\csname K#3\endcsname{%
    \ensuremath{\qopname\newmcodes@{\IfBooleanTF #1 m o} {\keyw{\IfNoValueTF {#2} {#3} {#2}}}}}}

\DeclareDocumentCommand \newmathconstant { s o m } {
  \message{math keyword K#3 = <#1,#2> ^^J}
  \expandafter\newcommand\csname K#3\endcsname{%
    \ensuremath{\qopname\newmcodes@{\IfBooleanTF #1 m o} {\mathkeyw{\IfNoValueTF {#2} {#3} {#2}}}}}}

\DeclareDocumentCommand \newvalue { s o m } {
  \message{value V#3 = <#1,#2> ^^J}
  \expandafter\newcommand\csname V#3\endcsname{%
    \ensuremath{\qopname\newmcodes@{\IfBooleanTF #1 m o} {\valuew{\IfNoValueTF {#2} {#3} {#2}}}}}}

\DeclareDocumentCommand \newtype { s o m } {
  \message{type V#3 = <#1,#2> ^^J}
  \expandafter\newcommand\csname T#3\endcsname{%
    \ensuremath{\qopname\newmcodes@{\IfBooleanTF #1 m o} {\typew{\IfNoValueTF {#2} {#3} {#2}}}}}}
\makeatother

% I - lambda-calcul simplement type

% I.1 lambda termes purs

\newconstant{I}
\newconstant{T}
\newconstant{F}
\newmathconstant[\Upsilon]{Y}
\newmathconstant[\Delta]{D}
\newmathconstant[\Omega]{O}

\newconstant{Z}
\newconstant{S}
\newconstant{if}
\newconstant{pair}
\newconstant{fst}
\newconstant{snd}

\newconstant{case}
\newconstant{in}

\newconstant{iter}
\newconstant{fact}

\newconstant{add}
\newconstant{pred}

\newcommand{\subst}[3]{\ensuremath{#1\langle{#2/{\color{red} #3}}}\rangle}

\newcommand{\rabs}[2]{\ensuremath{\lambda #1 . #2}}
\newcommand{\rapp}[2]{\ensuremath{#1 \; #2}}
\newcommand{\rappl}[2]{\ensuremath{\left( #1 \right) ~ #2}}
\newcommand{\rappr}[2]{\ensuremath{#1~ \left( #2 \right)}}
\newcommand{\rapplr}[2]{\ensuremath{\left( #1 \; #2 \right)}}

\newcommand{\riter}[3]{\ensuremath{\Kiter \; {#1} \; {#2} \, {#3}}}
\newcommand{\rifte}[3]{\ensuremath{\Kif \; #1 \; #2 \; #3}}
\newcommand{\rpair}[2]{\ensuremath{\Kpair \; #1 \; #2}}

\newcommand{\rcase}[3]{\ensuremath{\Kcase~ #1 ~\Kin \left\{ #2, #3 \right\}}}
\newcommand{\inleft}[2]{\ensuremath{\Kin_g(#1) \mapsto #2}}
\newcommand{\inright}[2]{\ensuremath{\Kin_d(#1) \mapsto #2}}

%% Entiers de Barendregt
\newcommand{\bnum}[1]{\lceil #1 \rceil}

%% Church-style abstraction
\newcommand{\tabs}[3]{\ensuremath{\lambda #2^{#1} . #3}}

%% Sert ou ?

\newtype{nat}
\newtype{bool}

\newvalue{true}
\newvalue{false}

% II systeme F

\newcommand{\rAbs}[2]{\ensuremath{\Lambda #1 . #2}}
\newcommand{\rApp}[2]{\ensuremath{#1 \; #2}}
\newcommand{\rAppl}[2]{\ensuremath{\left( #1 \right) ~ #2}}
\newcommand{\rAppr}[2]{\ensuremath{#1~ \left( #2 \right)}}
\newcommand{\rApplr}[2]{\ensuremath{\left( #1 \; #2 \right)}}

\newcommand{\Sem}[1]{\mathop{\left[ #1 \right]}\nolimits}

% III types dependants et types identite

\newcommand*{\issomething}[1]{\relax\ifnum\lastnodetype>0 \mskip\medmuskip\fi\text{\sffamily{\bfseries{#1}}}}

\newcommand{\isprop}{\issomething{prop}}
\newcommand{\istrue}{\issomething{true}}
\newcommand{\istype}{\issomething{type}}
\newcommand{\isctx}{\issomething{ctx}}

\newcommand{\prop}[1]{\ensuremath{#1\isprop}}
\newcommand{\type}[1]{\ensuremath{#1\istype}}
\newcommand{\judg}[1]{\ensuremath{#1\istrue}}
\newcommand{\ctx}[1]{\ensuremath{#1\isctx}}

\newtype{Prop}
\newtype{Type}

%\newconstant{I}

\newtype{Nat}
\newconstant[0]{zero}
\newconstant[S]{succ}

%\newconstant{fst}
%\newconstant{snd}

\newtype{Id}
\newconstant{J}
\newconstant{refl}
\newcommand{\idelim}[3]{\rapp{\KJ \left[ #1 \right]}{#2 ~ #3}}

\newconstant[tr]{tr}
\newcommand{\tr}[2]{\rapp{\Ktr \left[ #1 \right]}{#2}}

\newconstant{ap}
\newcommand{\ap}[2]{\rapp{\Kap_{#1}}{#2}}

\newconstant{apd}
\newcommand{\apd}[2]{\rapp{\Kapd_{#1}}{#2}}

